{"ast":null,"code":"import React,{useCallback,useState}from'react';import{useDropzone}from'react-dropzone';import{uploadPDF}from'../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const FileUpload=_ref=>{let{onUploadSuccess,onUploadError}=_ref;const[isUploading,setIsUploading]=useState(false);const onDrop=useCallback(async acceptedFiles=>{const file=acceptedFiles[0];if(!file)return;if(file.type!=='application/pdf'){onUploadError('PDFファイルのみアップロード可能です');return;}// 既にアップロード中の場合は処理をスキップ\nif(isUploading){return;}setIsUploading(true);try{const response=await uploadPDF(file);onUploadSuccess(response);}catch(error){var _error$response,_error$response2,_error$response3,_error$response3$data;console.error('Upload error details:',error);let errorMessage='アップロードに失敗しました';if(error.code==='ECONNABORTED'){errorMessage='アップロードがタイムアウトしました。ファイルサイズが大きすぎる可能性があります。';}else if(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===413){errorMessage='ファイルサイズが大きすぎます。';}else if(((_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.status)>=500){errorMessage='サーバーエラーが発生しました。しばらく待ってから再試行してください。';}else if((_error$response3=error.response)!==null&&_error$response3!==void 0&&(_error$response3$data=_error$response3.data)!==null&&_error$response3$data!==void 0&&_error$response3$data.detail){errorMessage=error.response.data.detail;}else if(error.message){errorMessage=error.message;}onUploadError(errorMessage);}finally{setIsUploading(false);}},[onUploadSuccess,onUploadError,isUploading]);const{getRootProps,getInputProps,isDragActive}=useDropzone({onDrop,accept:{'application/pdf':['.pdf']},multiple:false,disabled:isUploading});return/*#__PURE__*/_jsxs(\"div\",{...getRootProps(),style:{border:`2px dashed ${isUploading?'#999':'#ccc'}`,borderRadius:'10px',padding:'40px',textAlign:'center',cursor:isUploading?'not-allowed':'pointer',backgroundColor:isUploading?'#f5f5f5':isDragActive?'#f0f8ff':'#fafafa',transition:'all 0.2s ease',opacity:isUploading?0.7:1},children:[/*#__PURE__*/_jsx(\"input\",{...getInputProps()}),isUploading?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u30A2\\u30C3\\u30D7\\u30ED\\u30FC\\u30C9\\u4E2D...\"}),/*#__PURE__*/_jsx(\"div\",{style:{width:'50px',height:'50px',border:'3px solid #f3f3f3',borderTop:'3px solid #3498db',borderRadius:'50%',animation:'spin 1s linear infinite',margin:'0 auto'}})]}):/*#__PURE__*/_jsx(\"div\",{children:isDragActive?/*#__PURE__*/_jsx(\"p\",{children:\"PDF\\u30D5\\u30A1\\u30A4\\u30EB\\u3092\\u3053\\u3053\\u306B\\u30C9\\u30ED\\u30C3\\u30D7\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\"}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:\"PDF\\u30D5\\u30A1\\u30A4\\u30EB\\u3092\\u30C9\\u30E9\\u30C3\\u30B0\\uFF06\\u30C9\\u30ED\\u30C3\\u30D7\\u3059\\u308B\\u304B\\u3001\\u30AF\\u30EA\\u30C3\\u30AF\\u3057\\u3066\\u9078\\u629E\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\"}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'14px',color:'#666'},children:\".pdf \\u30D5\\u30A1\\u30A4\\u30EB\\u306E\\u307F\\u5BFE\\u5FDC\"})]})}),/*#__PURE__*/_jsx(\"style\",{children:`\n          @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n          }\n        `})]});};export default FileUpload;","map":{"version":3,"names":["React","useCallback","useState","useDropzone","uploadPDF","jsx","_jsx","jsxs","_jsxs","FileUpload","_ref","onUploadSuccess","onUploadError","isUploading","setIsUploading","onDrop","acceptedFiles","file","type","response","error","_error$response","_error$response2","_error$response3","_error$response3$data","console","errorMessage","code","status","data","detail","message","getRootProps","getInputProps","isDragActive","accept","multiple","disabled","style","border","borderRadius","padding","textAlign","cursor","backgroundColor","transition","opacity","children","width","height","borderTop","animation","margin","fontSize","color"],"sources":["C:/PDFAI/frontend/src/components/FileUpload.tsx"],"sourcesContent":["import React, { useCallback, useState } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport { uploadPDF } from '../services/api';\nimport { UploadResponse } from '../types';\n\ninterface FileUploadProps {\n  onUploadSuccess: (response: UploadResponse) => void;\n  onUploadError: (error: string) => void;\n}\n\nconst FileUpload: React.FC<FileUploadProps> = ({ onUploadSuccess, onUploadError }) => {\n  const [isUploading, setIsUploading] = useState(false);\n\n  const onDrop = useCallback(async (acceptedFiles: File[]) => {\n    const file = acceptedFiles[0];\n    if (!file) return;\n\n    if (file.type !== 'application/pdf') {\n      onUploadError('PDFファイルのみアップロード可能です');\n      return;\n    }\n\n    // 既にアップロード中の場合は処理をスキップ\n    if (isUploading) {\n      return;\n    }\n\n    setIsUploading(true);\n    try {\n      const response = await uploadPDF(file);\n      onUploadSuccess(response);\n    } catch (error: any) {\n      console.error('Upload error details:', error);\n      let errorMessage = 'アップロードに失敗しました';\n      \n      if (error.code === 'ECONNABORTED') {\n        errorMessage = 'アップロードがタイムアウトしました。ファイルサイズが大きすぎる可能性があります。';\n      } else if (error.response?.status === 413) {\n        errorMessage = 'ファイルサイズが大きすぎます。';\n      } else if (error.response?.status >= 500) {\n        errorMessage = 'サーバーエラーが発生しました。しばらく待ってから再試行してください。';\n      } else if (error.response?.data?.detail) {\n        errorMessage = error.response.data.detail;\n      } else if (error.message) {\n        errorMessage = error.message;\n      }\n      \n      onUploadError(errorMessage);\n    } finally {\n      setIsUploading(false);\n    }\n  }, [onUploadSuccess, onUploadError, isUploading]);\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    onDrop,\n    accept: {\n      'application/pdf': ['.pdf']\n    },\n    multiple: false,\n    disabled: isUploading\n  });\n\n  return (\n    <div\n      {...getRootProps()}\n      style={{\n        border: `2px dashed ${isUploading ? '#999' : '#ccc'}`,\n        borderRadius: '10px',\n        padding: '40px',\n        textAlign: 'center',\n        cursor: isUploading ? 'not-allowed' : 'pointer',\n        backgroundColor: isUploading ? '#f5f5f5' : (isDragActive ? '#f0f8ff' : '#fafafa'),\n        transition: 'all 0.2s ease',\n        opacity: isUploading ? 0.7 : 1\n      }}\n    >\n      <input {...getInputProps()} />\n      {isUploading ? (\n        <div>\n          <p>アップロード中...</p>\n          <div style={{ \n            width: '50px', \n            height: '50px', \n            border: '3px solid #f3f3f3',\n            borderTop: '3px solid #3498db',\n            borderRadius: '50%',\n            animation: 'spin 1s linear infinite',\n            margin: '0 auto'\n          }} />\n        </div>\n      ) : (\n        <div>\n          {isDragActive ? (\n            <p>PDFファイルをここにドロップしてください</p>\n          ) : (\n            <div>\n              <p>PDFファイルをドラッグ＆ドロップするか、クリックして選択してください</p>\n              <p style={{ fontSize: '14px', color: '#666' }}>\n                .pdf ファイルのみ対応\n              </p>\n            </div>\n          )}\n        </div>\n      )}\n      <style>\n        {`\n          @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n          }\n        `}\n      </style>\n    </div>\n  );\n};\n\nexport default FileUpload;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
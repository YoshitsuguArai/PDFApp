# PDF資料検索ツール

PDFファイルをアップロードしてハイブリッド検索（セマンティック検索 + キーワード検索）で資料を検索できるツールです。

## 機能

- **PDFアップロード**: ドラッグ&ドロップまたはクリックでPDFファイルをアップロード
- **ハイブリッド検索**: 3つの検索方式を選択可能
  - **ハイブリッド検索** (推奨): セマンティック検索とキーワード検索を組み合わせた高精度検索
  - **セマンティック検索**: OpenAI Embeddingを使用した意味の類似性に基づく検索
  - **キーワード検索**: TF-IDFを使用した従来のキーワードマッチ検索
- **検索結果表示**: スコア付きでハイライト表示、ページ番号と検索タイプも表示

## 技術スタック

### バックエンド
- **FastAPI**: RESTful API
- **OpenAI API**: テキスト埋め込み（text-embedding-3-small）
- **ChromaDB**: ベクトルデータベース
- **PyPDF2**: PDF処理とテキスト抽出
- **scikit-learn**: TF-IDF ベクトル化
- **sentence-transformers**: ローカル埋め込みモデル（フォールバック用）

### フロントエンド
- **React + TypeScript**: ユーザーインターフェース
- **react-dropzone**: ファイルアップロード
- **axios**: HTTP通信

## セットアップ

### 1. リポジトリのクローン
```bash
git clone <repository-url>
cd PDFAI
```

### 2. バックエンドのセットアップ
```bash
cd backend

# 仮想環境を作成（推奨）
python -m venv venv
# Windows
venv\\Scripts\\activate
# macOS/Linux
source venv/bin/activate

# 依存関係をインストール
pip install -r requirements.txt

# 環境変数を設定
cp .env.example .env
# .envファイルを編集してOpenAI APIキーを設定
```

### 3. フロントエンドのセットアップ
```bash
cd ../frontend

# 依存関係をインストール
npm install
```

### 4. 環境変数の設定
`.env`ファイルを編集して以下を設定：
```
OPENAI_API_KEY=your_openai_api_key_here
```

## 実行方法

### バックエンドサーバーの起動
```bash
cd backend
python main.py
```
サーバーは http://localhost:8000 で起動します。

### フロントエンドサーバーの起動
```bash
cd frontend
npm start
```
アプリケーションは http://localhost:3000 で起動します。

## 使用方法

1. **PDFアップロード**: ホーム画面でPDFファイルをアップロード
2. **検索**: 検索ボックスに検索したい内容を入力
3. **検索タイプ選択**:
   - ハイブリッド（推奨）: 高精度な総合検索
   - セマンティック: 意味の類似性で検索
   - キーワード: 単語の一致で検索
4. **結果表示**: スコア順で検索結果が表示されます

## API エンドポイント

- `POST /upload`: PDFファイルのアップロード
- `POST /search`: ドキュメント検索
- `GET /documents/count`: 登録済みドキュメント数の取得
- `DELETE /documents`: すべてのドキュメントを削除

## 検索の仕組み

### セマンティック検索
- OpenAI APIで文章をベクトル化
- ChromaDBでコサイン類似度による検索
- 意味の類似性を重視

### キーワード検索
- TF-IDFベクトライザーで文章を数値化
- 単語の重要度と頻度で検索
- 正確なキーワードマッチを重視

### ハイブリッド検索
- セマンティック検索とキーワード検索の結果をマージ
- スコアを統合して最適な結果を提供
- デフォルトではセマンティック70%、キーワード30%の重み付け

## 注意事項

- OpenAI APIキーが必要です
- 初回実行時にローカル埋め込みモデルのダウンロードが発生する場合があります
- 大きなPDFファイルの処理には時間がかかる場合があります

## トラブルシューティング

### よくある問題
1. **OpenAI APIエラー**: `.env`ファイルにAPIキーが正しく設定されているか確認
2. **依存関係エラー**: `pip install -r requirements.txt`を再実行
3. **ポートエラー**: バックエンド（8000）とフロントエンド（3000）のポートが使用可能か確認

### ログの確認
バックエンドのコンソール出力でエラーログを確認できます。